!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(0,function(){"use strict";function e(e){E.push(e),M||(M=!0,N(r))}function t(e){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(e)||e}function r(){M=!1;var e=E;E=[],e.sort(function(e,t){return e.uid_-t.uid_});var t=!1;e.forEach(function(e){var r=e.takeRecords();n(e),r.length&&(e.callback_(r,e),t=!0)}),t&&r()}function n(e){e.nodes_.forEach(function(t){var r=g.get(t);r&&r.forEach(function(t){t.observer===e&&t.removeTransientObservers()})})}function i(e,t){for(var r=e;r;r=r.parentNode){var n=g.get(r);if(n)for(var i=0;i<n.length;i++){var o=n[i],a=o.options;if(r===e||a.subtree){var s=t(a);s&&o.enqueue(s)}}}}function o(e){this.callback_=e,this.nodes_=[],this.records_=[],this.uid_=++I}function a(e,t){this.type=e,this.target=t,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function s(e){var t=new a(e.type,e.target);return t.addedNodes=e.addedNodes.slice(),t.removedNodes=e.removedNodes.slice(),t.previousSibling=e.previousSibling,t.nextSibling=e.nextSibling,t.attributeName=e.attributeName,t.attributeNamespace=e.attributeNamespace,t.oldValue=e.oldValue,t}function d(e,t){return D=new a(e,t)}function u(e){return S||(S=s(D),S.oldValue=e,S)}function h(){D=S=void 0}function l(e){return e===S||e===D}function c(e,t){return e===t?e:S&&l(e)?S:null}function f(e,t,r){this.observer=e,this.target=t,this.options=r,this.transientObservedNodes=[]}var v=function(e,t){var r=window.Element.prototype,n=r.matches||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector||r.webkitMatchesSelector;if(!e||1!==e.nodeType)return!1;var i=e.parentNode;if(n)return n.call(e,t);for(var o=i.querySelectorAll(t),a=o.length,s=0;s<a;s++)if(o[s]===e)return!0;return!1},b=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,y=window.WeakMap;if(void 0===y){var m=Object.defineProperty,_=Date.now()%1e9;(y=function(){this.name="__st"+(1e9*Math.random()>>>0)+_+++"__"}).prototype={set:function(e,t){var r=e[this.name];return r&&r[0]===e?r[1]=t:m(e,this.name,{value:[e,t],writable:!0}),this},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},delete:function(e){var t=e[this.name];if(!t)return!1;var r=t[0]===e;return t[0]=t[1]=void 0,r},has:function(e){var t=e[this.name];return!!t&&t[0]===e}}}var g=new y,N=window.msSetImmediate;if(!N){var p=[],w=String(Math.random());window.addEventListener("message",function(e){if(e.data===w){var t=p;p=[],t.forEach(function(e){e()})}}),N=function(e){p.push(e),window.postMessage(w,"*")}}var M=!1,E=[],I=0;o.prototype={observe:function(e,r){if(e=t(e),!r.childList&&!r.attributes&&!r.characterData||r.attributeOldValue&&!r.attributes||r.attributeFilter&&r.attributeFilter.length&&!r.attributes||r.characterDataOldValue&&!r.characterData)throw new SyntaxError;var n=g.get(e);n||g.set(e,n=[]);for(var i,o=0;o<n.length;o++)if(n[o].observer===this){(i=n[o]).removeListeners(),i.options=r;break}i||(i=new f(this,e,r),n.push(i),this.nodes_.push(e)),i.addListeners()},disconnect:function(){this.nodes_.forEach(function(e){for(var t=g.get(e),r=0;r<t.length;r++){var n=t[r];if(n.observer===this){n.removeListeners(),t.splice(r,1);break}}},this),this.records_=[]},takeRecords:function(){var e=this.records_;return this.records_=[],e}};var D,S;f.prototype={enqueue:function(t){var r=this.observer.records_,n=r.length;if(r.length>0){var i=c(r[n-1],t);if(i)return void(r[n-1]=i)}else e(this.observer);r[n]=t},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(e){var t=this.options;t.attributes&&e.addEventListener("DOMAttrModified",this,!0),t.characterData&&e.addEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.addEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(e){var t=this.options;t.attributes&&e.removeEventListener("DOMAttrModified",this,!0),t.characterData&&e.removeEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.removeEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(e){if(e!==this.target){this.addListeners_(e),this.transientObservedNodes.push(e);var t=g.get(e);t||g.set(e,t=[]),t.push(this)}},removeTransientObservers:function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(e){this.removeListeners_(e);for(var t=g.get(e),r=0;r<t.length;r++)if(t[r]===this){t.splice(r,1);break}},this)},handleEvent:function(e){switch(e.stopImmediatePropagation(),e.type){case"DOMAttrModified":var t=e.attrName,r=e.relatedNode.namespaceURI,n=e.target;(o=new d("attributes",n)).attributeName=t,o.attributeNamespace=r;a=e.attrChange===MutationEvent.ADDITION?null:e.prevValue;i(n,function(e){if(e.attributes&&(!e.attributeFilter||!e.attributeFilter.length||-1!==e.attributeFilter.indexOf(t)||-1!==e.attributeFilter.indexOf(r)))return e.attributeOldValue?u(a):o});break;case"DOMCharacterDataModified":var o=d("characterData",n=e.target),a=e.prevValue;i(n,function(e){if(e.characterData)return e.characterDataOldValue?u(a):o});break;case"DOMNodeRemoved":this.addTransientObserver(e.target);case"DOMNodeInserted":var s,l,n=e.relatedNode,c=e.target;"DOMNodeInserted"===e.type?(s=[c],l=[]):(s=[],l=[c]);var f=c.previousSibling,v=c.nextSibling;(o=d("childList",n)).addedNodes=s,o.removedNodes=l,o.previousSibling=f,o.nextSibling=v,i(n,function(e){if(e.childList)return o})}h()}},b||(b=o);var k=b,x=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},O=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();!function(e){function t(e,r,n){if(e.nodeType==Node.ELEMENT_NODE){var i=e;r&&r(i);var o=i.shadowRoot||i.webkitShadowRoot;if(o)return void t(o,r,o);if("content"==i.localName){for(var a=i,s=a.getDistributedNodes?a.getDistributedNodes():[],d=0;d<s.length;d++)t(s[d],r,n);return}if("slot"==i.localName){for(var u=i,h=u.assignedNodes?u.assignedNodes({flatten:!0}):[],l=0;l<h.length;l++)t(h[l],r,n);return}}for(var c=e.firstChild;null!=c;)t(c,r,n),c=c.nextSibling}function r(t){if(!t.querySelector("style#inert-style")){var r=e.createElement("style");r.setAttribute("id","inert-style"),r.textContent="\n[inert] {\n  pointer-events: none;\n  cursor: default;\n}\n\n[inert], [inert] * {\n  user-select: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n}\n",t.appendChild(r)}}function n(e,t){return t&&(e===t||!!(16&e.compareDocumentPosition(t)))}var i=["a[href]","area[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","iframe","object","embed","[contenteditable]"].join(","),o=function(){function r(e,t){x(this,r),this._inertManager=t,this._rootElement=e,this._managedNodes=new Set([]),this._rootElement.setAttribute("aria-hidden","true"),this._makeSubtreeUnfocusable(this._rootElement),this._observer=new k(this._onMutation.bind(this)),this._observer.observe(this._rootElement,{attributes:!0,childList:!0,subtree:!0})}return O(r,[{key:"destructor",value:function(){this._observer.disconnect(),this._observer=null,this._rootElement&&this._rootElement.removeAttribute("aria-hidden"),this._rootElement=null;var e=!0,t=!1,r=void 0;try{for(var n,i=this._managedNodes[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var o=n.value;this._unmanageNode(o.node)}}catch(e){t=!0,r=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw r}}this._managedNodes=null,this._inertManager=null}},{key:"_makeSubtreeUnfocusable",value:function(r){var i=this;t(r,function(e){return i._visitNode(e)});var o=e.activeElement;if(!n(e.body,r)){for(var a=r,s=void 0;a;){if(a.nodeType===Node.DOCUMENT_FRAGMENT_NODE){s=a;break}a=a.parentNode}s&&(o=s.activeElement)}n(r,o)&&o.blur()}},{key:"_visitNode",value:function(e){e.nodeType===Node.ELEMENT_NODE&&(e!==this._rootElement&&e.hasAttribute("inert")&&this._adoptInertRoot(e),(v(e,i)||e.hasAttribute("tabindex"))&&this._manageNode(e))}},{key:"_manageNode",value:function(e){var t=this._inertManager.register(e,this);this._managedNodes.add(t)}},{key:"_unmanageNode",value:function(e){var t=this._inertManager.deregister(e,this);t&&this._managedNodes.delete(t)}},{key:"_unmanageSubtree",value:function(e){var r=this;t(e,function(e){return r._unmanageNode(e)})}},{key:"_adoptInertRoot",value:function(e){var t=this._inertManager.getInertRoot(e);t||(this._inertManager.setInert(e,!0),t=this._inertManager.getInertRoot(e));var r=!0,n=!1,i=void 0;try{for(var o,a=t.managedNodes[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var s=o.value;this._manageNode(s.node)}}catch(e){n=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(n)throw i}}}},{key:"_onMutation",value:function(e,t){var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var d=a.value,u=d.target;if("childList"===d.type){var h=!0,l=!1,c=void 0;try{for(var f,v=Array.from(d.addedNodes)[Symbol.iterator]();!(h=(f=v.next()).done);h=!0){var b=f.value;this._makeSubtreeUnfocusable(b)}}catch(e){l=!0,c=e}finally{try{!h&&v.return&&v.return()}finally{if(l)throw c}}var y=!0,m=!1,_=void 0;try{for(var g,N=Array.from(d.removedNodes)[Symbol.iterator]();!(y=(g=N.next()).done);y=!0){var p=g.value;this._unmanageSubtree(p)}}catch(e){m=!0,_=e}finally{try{!y&&N.return&&N.return()}finally{if(m)throw _}}}else if("attributes"===d.type)if("tabindex"===d.attributeName)this._manageNode(u);else if(u!==this._rootElement&&"inert"===d.attributeName&&u.hasAttribute("inert")){this._adoptInertRoot(u);var w=this._inertManager.getInertRoot(u),M=!0,E=!1,I=void 0;try{for(var D,S=this._managedNodes[Symbol.iterator]();!(M=(D=S.next()).done);M=!0){var k=D.value;n(u,k.node)&&w._manageNode(k.node)}}catch(e){E=!0,I=e}finally{try{!M&&S.return&&S.return()}finally{if(E)throw I}}}}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}}},{key:"managedNodes",get:function(){return new Set(this._managedNodes)}}]),r}(),a=function(){function e(t,r){x(this,e),this._node=t,this._overrodeFocusMethod=!1,this._inertRoots=new Set([r]),this._destroyed=!1,this.ensureUntabbable()}return O(e,[{key:"destructor",value:function(){this._throwIfDestroyed(),this._node&&(this.hasSavedTabIndex?this._node.setAttribute("tabindex",this.savedTabIndex):this._node.removeAttribute("tabindex"),this._overrodeFocusMethod&&delete this._node.focus),this._node=null,this._inertRoots=null,this._destroyed=!0}},{key:"_throwIfDestroyed",value:function(){if(this.destroyed)throw new Error("Trying to access destroyed InertNode")}},{key:"ensureUntabbable",value:function(){var e=this.node;if(v(e,i)){if(-1===e.tabIndex&&this.hasSavedTabIndex)return;e.hasAttribute("tabindex")&&(this._savedTabIndex=e.tabIndex),e.setAttribute("tabindex","-1"),e.nodeType===Node.ELEMENT_NODE&&(e.focus=function(){},this._overrodeFocusMethod=!0)}else e.hasAttribute("tabindex")&&(this._savedTabIndex=e.tabIndex,e.removeAttribute("tabindex"))}},{key:"addInertRoot",value:function(e){this._throwIfDestroyed(),this._inertRoots.add(e)}},{key:"removeInertRoot",value:function(e){this._throwIfDestroyed(),this._inertRoots.delete(e),0===this._inertRoots.size&&this.destructor()}},{key:"destroyed",get:function(){return this._destroyed}},{key:"hasSavedTabIndex",get:function(){return"_savedTabIndex"in this}},{key:"node",get:function(){return this._throwIfDestroyed(),this._node}},{key:"savedTabIndex",set:function(e){this._throwIfDestroyed(),this._savedTabIndex=e},get:function(){return this._throwIfDestroyed(),this._savedTabIndex}}]),e}(),s=new(function(){function e(t){if(x(this,e),!t)throw new Error("Missing required argument; InertManager needs to wrap a document.");this._document=t,this._managedNodes=new Map,this._inertRoots=new Map,this._observer=new k(this._watchForInert.bind(this)),r(t.head||t.body||t.documentElement),"loading"===t.readyState?t.addEventListener("DOMContentLoaded",this._onDocumentLoaded.bind(this)):this._onDocumentLoaded()}return O(e,[{key:"setInert",value:function(e,t){if(t){if(this._inertRoots.has(e))return;var i=new o(e,this);if(e.setAttribute("inert",""),this._inertRoots.set(e,i),!n(this._document.body,e))for(var a=e.parentNode;a;)11===a.nodeType&&r(a),a=a.parentNode}else{if(!this._inertRoots.has(e))return;this._inertRoots.get(e).destructor(),this._inertRoots.delete(e),e.removeAttribute("inert")}}},{key:"getInertRoot",value:function(e){return this._inertRoots.get(e)}},{key:"register",value:function(e,t){var r=this._managedNodes.get(e);return void 0!==r?(r.addInertRoot(t),r.ensureUntabbable()):r=new a(e,t),this._managedNodes.set(e,r),r}},{key:"deregister",value:function(e,t){var r=this._managedNodes.get(e);return r?(r.removeInertRoot(t),r.destroyed&&this._managedNodes.delete(e),r):null}},{key:"_onDocumentLoaded",value:function(){var e=Array.from(this._document.querySelectorAll("[inert]")),t=!0,r=!1,n=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this.setInert(a,!0)}}catch(e){r=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw n}}this._observer.observe(this._document.body,{attributes:!0,subtree:!0,childList:!0})}},{key:"_watchForInert",value:function(e,t){var r=!0,n=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var s=o.value;switch(s.type){case"childList":var d=!0,u=!1,h=void 0;try{for(var l,c=Array.from(s.addedNodes)[Symbol.iterator]();!(d=(l=c.next()).done);d=!0){var f=l.value;if(f.nodeType===Node.ELEMENT_NODE){var b=Array.from(f.querySelectorAll("[inert]"));v(f,"[inert]")&&b.unshift(f);var y=!0,m=!1,_=void 0;try{for(var g,N=b[Symbol.iterator]();!(y=(g=N.next()).done);y=!0){var p=g.value;this.setInert(p,!0)}}catch(e){m=!0,_=e}finally{try{!y&&N.return&&N.return()}finally{if(m)throw _}}}}}catch(e){u=!0,h=e}finally{try{!d&&c.return&&c.return()}finally{if(u)throw h}}break;case"attributes":if("inert"!==s.attributeName)continue;var w=s.target,M=w.hasAttribute("inert");this.setInert(w,M)}}}catch(e){n=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(n)throw i}}}}]),e}())(e);Object.defineProperty(Element.prototype,"inert",{enumerable:!0,get:function(){return this.hasAttribute("inert")},set:function(e){s.setInert(this,e)}})}(document)});
